import com.evento.cli.PublishBundle
import com.evento.cli.UpdateVersion

buildscript {
    repositories {
        mavenCentral()
        mavenLocal()
    }
    dependencies {
        classpath 'com.eventoframework:evento-cli:ev1.7.2'
    }
}


plugins {
    id 'java'
    id 'java-library'
}

group 'com.evento'
version '1.0-SNAPSHOT'

repositories {
    mavenCentral()
    mavenLocal()
}


dependencies {
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.9.0'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.9.0'


    api(project(':evento-bundle'))
    api(project(':evento-common'))
    api 'io.sentry:sentry:6.23.0'
}

test {
    useJUnitPlatform()
}

tasks.register('eventoUpdateVersion') {
    dependsOn 'clean'
    doLast {
        UpdateVersion.run(file("./src").toString())
    }
}
tasks.register('eventoPublish') {
    dependsOn 'jar'
    doLast {
        PublishBundle.run(file(".").toString(), 'http://localhost:3000',
                'https://github.com/EventoFramework/evento-framework/blob/main/evento-demo/evento-demo-api',
                'eyJraWQiOiJldmVudG8tc2VydmVyLWF1dGgta2V5IiwiYWxnIjoiSFMyNTYiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJldmVudG8tc2VydmVyIiwiY2xpZW50SWQiOiJkZXBsb3lLZXkiLCJyb2xlIjpbIlJPTEVfUFVCTElTSCJdLCJpYXQiOjE3MDk2NjM1NTYsImV4cCI6MTc0MTE5OTU1NiwianRpIjoiNmJlMGM5YTQtZDQ0Ni00NzE1LWJlNzAtY2NkMzgxMmExNWI2IiwibmJmIjoxNzA5NjYzNTU1fQ.MIGuorOyP__sPwfWnZyKhuhIhvjaRj-Kojl94hTzc9c')
    }
}
tasks.register('eventoUpdateVersionAndPublish') {
    dependsOn 'eventoUpdateVersion'
    finalizedBy(eventoPublish)
}
